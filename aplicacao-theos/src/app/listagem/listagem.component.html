<div class="container mt-5 mx-auto">
  <div class="col-12">
    <input type="search" class="form-control ds-input" id="search-input" placeholder="Buscar..."
      (keyup)="search($event.target.value)">
  </div>
  <div class="col-12">
    <div class="table-responsive mt-3">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Nome</th>
            <th scope="col">Sobrenome</th>
            <th scope="col">E-mail</th>
            <th scope="col">Estado</th>
            <th scope="col">Cidade</th>
            <th scope="col">Sexo</th>
            <th scope="col">Area de Formação</th>
            <th scope="col">Profissão</th>
            <th scope="col">Data</th>
            <th scope="col">Editar</th>
            <th scope="col">Excluir</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let u of usuarios; let i = index;">
            <td>{{u.nome}}</td>
            <td>{{u.sobrenome}}</td>
            <td>{{u.email}}</td>
            <td>{{u.estado}}</td>
            <td>{{u.cidade}}</td>
            <td>{{u.sexo}}</td>
            <td>{{u.areaFormacao}}</td>
            <td>{{u.profissao}}</td>
            <td>{{u.createdon | date: 'dd/MM/yyyy'}}</td>
            <td class="bt-images">
              <img src="../../assets/images/bt-editar.png" alt="editar" data-toggle="modal" data-target="#modalEditar"
                (click)="editar(u)">
            </td>
            <td class="bt-images">
                <img src="../../assets/images/bt-delete.png" alt="deletar" data-toggle="modal" data-target="#modalExcluir"
                (click)="getUsuario(u)">
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="modal fade" id="modalExcluir" tabindex="-1" role="dialog" aria-labelledby="popupExcluir" aria-hidden="true"
  *ngIf="usuario">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="popupEditar">Excluir usuario: <span class="font-weight-bold"> {{usuario.nome}}
          </span></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h4>Tem certeza que deseja excluir esse usuário?</h4>
      </div>
      <div class="form-group modal-footer">
        <button type="submit" class="btn btn-primary" (click)="deletar()">sim</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">não</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modalEditar" tabindex="-1" role="dialog" aria-labelledby="popupEditar" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="popupEditar">Editar cadastro</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="form" [formGroup]="formulario" (ngSubmit)="onSubmit(modalEditar)" role="form" autocomplete="off">
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Nome</label>
            <div class="col-lg-9">
              <input class="form-control" type="text" formControlName="nome">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Sobrenome</label>
            <div class="col-lg-9">
              <input class="form-control" type="text" formControlName="sobrenome">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Email</label>
            <div class="col-lg-9">
                <input class="form-control" type="email" formControlName="email"
                  [ngClass]="{ 'is-invalid': submitted && formListagem.email.errors }">
                <div *ngIf="submitted && formListagem.email.errors">
                  <div *ngIf="formListagem.email.errors.required" class="error">Email é obrigatório</div>
                  <div *ngIf="formListagem.email.errors.email"  class="error">Deve ser um endereço de e-mail válido</div>
                </div>
              </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Sexo</label>
            <div class="col-lg-9">
              <select class="form-control" size="0" formControlName="sexo">
                <option value="Femenino">Femenino</option>
                <option value="Masculino">Masculino</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Data</label>
            <div class="col-lg-9">
              <input class="form-control" type="date" formControlName="data">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Estado</label>
            <div class="col-lg-9">
              <select class="form-control" size="0" formControlName="estado"
                (change)="selectOptionState($event.target.value)">
                <option [value]="estado.nome" *ngFor="let estado of estados">{{estado.nome}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Cidade</label>
            <div class="col-lg-9">
              <select class="form-control" size="0" formControlName="cidade">
                <option [value]="cidade" *ngFor="let cidade of cidades">{{cidade}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Área de Formação</label>
            <div class="col-lg-9">
              <input class="form-control" type="text" value="janeuser" formControlName="areaFormacao">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-lg-3 col-form-label form-control-label">Profissões</label>
            <div class="col-lg-9">
              <select class="form-control" size="0" formControlName="profissao">
                <option [value]="p" *ngFor="let p of profissoes">{{p}}</option>
              </select>
            </div>
          </div>
          <div class="form-group modal-footer">
            <button type="submit" class="btn btn-primary">Salvar</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
